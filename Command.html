<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>C&lt;DFA::Command&gt; - A Discrete Finite Automata command processor.</title>
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#installation">INSTALLATION</a></li>
	<li><a href="#features">FEATURES</a></li>
	<li><a href="#test_scripts">TEST SCRIPTS</a></li>
	<li><a href="#configuration_options">CONFIGURATION OPTIONS</a></li>
	<li><a href="#warning">WARNING</a></li>
	<li><a href="#format_of_a_state_transition_table">FORMAT OF A STATE TRANSITION TABLE</a></li>
	<li><a href="#q_&_a">Q &amp; A</a></li>
	<li><a href="#dereferencing_guidelines">DEREFERENCING GUIDELINES</a></li>
	<li><a href="#processing_of_#if_defined()">PROCESSING of #if <code>defined()</code></a></li>
	<li><a href="#warning_re_perl_bug">WARNING re Perl bug</a></li>
	<li><a href="#acknowledgements">ACKNOWLEDGEMENTS</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#licence">LICENCE</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p><code>DFA::Command</code> - A Discrete Finite Automata command processor.</p>
<p><code>DFA::Generate</code> - A DFA program generator.</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
        use DFA::Command;</pre>
<pre>
        $stateMachine = new DFA::Command('Name of first event');
        # Or:
        #$stateMachine = DFA::Command -&gt; new('Name of first event');</pre>
<pre>
        $stateMachine -&gt; load('Name of STT file');
        $stateMachine -&gt; dump() if ($YouAreDebugging);</pre>
<pre>
        $stateMachine -&gt; process('Name of a event file');</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p><code>DFA::Command</code></p>
<p>This module reads a state transition table and then reads a data file
looking for patterns as defined by regular expressions in the state
transition table. When a transition is detected, a sub is called.</p>
<p><code>DFA::Generate</code></p>
<p>This module reads a state transition table and generates a Perl
script which uses the module <code>DFA::Command</code> to process data according
to the said table.</p>
<p>These 2 modules are installed together.</p>
<p>The name <code>DFA::Command</code> was chosen because:</p>
<ul>
<li></li>
Somebody beat me to it. I wanted to use FSM (Finite State Machine)
<p></p>
<li></li>
It creates an appropriate and convenient naming structure for related packages
<p></p>
<li></li>
It installs easily in Unix, DOS and NT file systems
<p></p>
<li></li>
It was developed in an environment where the input file contained commands
and non-commands
<p></p></ul>
<p>
</p>
<hr />
<h1><a name="installation">INSTALLATION</a></h1>
<p>You install <code>DFA::Command</code>, as you would install any perl module library,
by running these commands:</p>
<pre>
        perl Makefile.PL
        make
        make test
        make install</pre>
<p>If you want to install a private copy of <code>DFA::Command</code> in your home
directory, then you should try to produce the initial Makefile with
something like this command:</p>
<pre>
        perl Makefile.PL LIB=~/perl
                or
        perl Makefile.PL LIB=C:/Perl/Site/Lib</pre>
<p>If, like me, you don't have permission to write man pages into unix system
directories, use:</p>
<pre>
        make pure_install</pre>
<p>instead of make install. This option is secreted in the middle of p 414 of the
second edition of the dromedary book.</p>
<p>
</p>
<hr />
<h1><a name="features">FEATURES</a></h1>
<p>When input is recognised, and an action function is about to be called,
<code>popEvent()</code> checks that the event just detected was one of those expected
in the current state.</p>
<p>Just after an action function is called, the names of those events expected
next are saved by <code>pushEvent()</code>, in preparation for the next call to
popEvent(). This feature and the previous one add overhead to the code,
but form a marvellous debugging aid.</p>
<p>
</p>
<hr />
<h1><a name="test_scripts">TEST SCRIPTS</a></h1>
<p>This package contains 3 sets of test files:</p>
<ul>
<li></li>
Chinese
<p></p>
<li></li>
Citizen
<p></p>
<li></li>
X500
<p></p></ul>
<p>Each set of test files contains:</p>
<ul>
<li></li>
<table cellspacing="0" cellpadding="0"><tr><td>A state transition table.
<tr><td><td>These files are called:
<tr><td><td>Chinese.STT, Citizen.STT and X500DN.STT.</table>
<p></p>
<li></li>
<table cellspacing="0" cellpadding="0"><tr><td>A data file comtaining commands to be recognized by the DFA.
<tr><td><td>These files are called:
<tr><td><td>Chinese.dat, Citizen.dat and X500DN.dat.</table>
<p></p>
<li></li>
<table cellspacing="0" cellpadding="0"><tr><td>A script (1) demonstrating DFA::Generate, which when run generates a script (2)
<tr><td><td>demonstrating DFA::Command.
<tr><td><td>These scripts (1) are called:
<tr><td><td>Chinese_Gen.pl, Citizen_Gen.pl and X500DN_Gen.pl.</table>
<p></p>
<li></li>
<table cellspacing="0" cellpadding="0"><tr><td>A script (2) which is the output of the previous script (1).
<tr><td><td>These scripts (2) are called:
<tr><td><td>ChineseTest.pl, CitizenTest.pl and X500DNTest.pl.</table>
<p></p>
<li></li>
<table cellspacing="0" cellpadding="0"><tr><td>A script (3) which is a version of (2), ie which I have generated and then modified
<tr><td><td>to demonstrate some possibilities.
<tr><td><td>These scripts (3) are called:
<tr><td><td>Chinese.pl, Citizen.pl and X500DN.pl.</table>
<p></p>
<li></li>
<table cellspacing="0" cellpadding="0"><tr><td>2 log files output by these 2 scripts (2, 3).
<tr><td><td>These logs are called:
<tr><td><td>ChineseTest.log, Chinese.log, CitizenTest.log, Citizen.log, X500DNTest.log,
<tr><td><td>X500DN.log.</table>
<p></p></ul>
<p>These scripts are all in a subdirectory called test. They are not in a subdirectory
called t because the test harness does not provide for scripts to be run which
generate scripts to be run.</p>
<p>
</p>
<hr />
<h1><a name="configuration_options">CONFIGURATION OPTIONS</a></h1>
<p>chomp. Chomp each input line before processing it. Default: True</p>
<p>commentPrefix. Ignore any input lines which start with this character. If
trimLeading is false, and a line starts with whitespace followed by this
character, that line will still be ignored. Default: '#'</p>
<p>ignoreBlankLines. If true, ignore input lines which are blank after any chomping.
Default: True</p>
<p>trimLeading. If true, trim leading whitespace from each input line before
processing it. Default: True</p>
<p>trimTrailing. If true, trim trailing whitespace from each input line before
processing it. This takes place after any chomping. Default: True</p>
<p>
</p>
<hr />
<h1><a name="warning">WARNING</a></h1>
<p>Go to any lengths whatsoever to avoid '%' characters in your input, since some
C compilers butcher such input. Eg: The thrice-cursed Pyramid C++ compiler.</p>
<p>
</p>
<hr />
<h1><a name="format_of_a_state_transition_table">FORMAT OF A STATE TRANSITION TABLE</a></h1>
<p>Typically, there will be several lines for each state. These lines will differ by
their event names, and the corresponding regexp which recognises the given event.</p>
<p>Each line consists of these fields:</p>
<ul>
<li></li>
The name of the state. Use \w as your guideline for forming names - ie no whitespace
<p></p>
<li></li>
The regexp to be used to search for an event in the input line. In colloquial
terms, this means the regexp to be used to search for the presence of a
command in the input line. The arrival of this command is the event in
question. Don't use whitespace within the regexp, since these lines are
split on whitespace. (No package is perfect...)
<p></p>
<li></li>
The name of the event detected if the regexp fires. Use \w - ie no whitespace
<p></p>
<li></li>
The name of the action function to call if the regexp fires
<p></p>
<li></li>
The names of the events which are allowed to follow the current event. Separate
event names with '|', without surrounding whitespace. Alternately, as syntactic
sugar, use the special token commandList to refer to all events where the name
of the state is 'commandState'
<p></p></ul>
<p>
</p>
<hr />
<h1><a name="q_&_a">Q &amp; A</a></h1>
<p>How do I skip input text? Use a regexp of '.*' in your state transition table.</p>
<p>If my input is 'abcd' and I have 2 regexps, 'abc.*' and 'abcd.*', which regexp
fires? Hmmm. Grammatically speaking, that is a question. Seriously tho, the
order of evaluation will be the order in which keys are stored in hashes,
which is not under user control. In short, you bungled it by using
ambiguous regexps.</p>
<p>
</p>
<hr />
<h1><a name="dereferencing_guidelines">DEREFERENCING GUIDELINES</a></h1>
<pre>
        $self -&gt; {$state} -&gt; {$event} -&gt; {'sub'}          Name of subroutine
        $self -&gt; {$state} -&gt; {$event} -&gt; {'nextState'}    Name of state
        $self -&gt; {$state} -&gt; {$event} -&gt; {'validEvents'}  Event|Event
        $self -&gt; {$state} -&gt; {'RE'}                       [REs]
        $self -&gt; {$state} -&gt; {'event'}                    [Events]
        $self -&gt; {'nextEvent'}                            [Expected events]
        $self -&gt; {'state'}                                Current state
        $self -&gt; {'event'}                                Current event
        $self -&gt; {'command'}                              Current command
        $self -&gt; {'RE'}                                   Current RE
        $self -&gt; {'original'}                             Current input line, original
        $self -&gt; {'clean'}                                Current input line, cleaned up
        $self -&gt; {'$1'}                                   Current text matching () IN RE
        $self -&gt; {'$2'}                                   Current text matching () IN RE
        $self -&gt; {'$3'}                                   Current text matching () IN RE</pre>
<p>
</p>
<hr />
<h1><a name="processing_of_#if_defined()">PROCESSING of #if <code>defined()</code></a></h1>
<p>Reference: PC Techniques, Aug/Sep 1993, p 102, Hax 166. Unimplemented.</p>
<p>
</p>
<hr />
<h1><a name="warning_re_perl_bug">WARNING re Perl bug</a></h1>
<p>As always, be aware that these 2 lines mean the same thing, sometimes:</p>
<ul>
<li></li>
$self -&gt; {'thing'}
<p></p>
<li></li>
$self-&gt;{'thing'}
<p></p></ul>
<p>The problem is the spaces around the -&gt;. Inside double quotes, ``...'', the
first space stops the dereference taking place. Outside double quotes the
scanner correctly associates the $self token with the {'thing'} token.</p>
<p>I regard this as a bug.</p>
<p>
</p>
<hr />
<h1><a name="acknowledgements">ACKNOWLEDGEMENTS</a></h1>
<p>The processing loop at the heart of this module is something I downloaded from
comp.land.perl.misc circa 1994. I encourage the author to contact me.</p>
<p>You'll know who you are: There were 2 bugs - both harmless - in 1 line of code,
in the routine I call load(). Anybody who accepts responsibility for this code
will be deemed to be the author. Well done!</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p><code>DFA::Command</code> and <code>DFA::Generate</code> were written by Ron Savage
<em>&lt;<a href="mailto:ron@savage.net.au">ron@savage.net.au</a>&gt;</em> in 1997.</p>
<p>
</p>
<hr />
<h1><a name="licence">LICENCE</a></h1>
<p>Australian copyright (c) 1997-2002 Ron Savage.</p>
<pre>
        All Programs of mine are 'OSI Certified Open Source Software';
        you can redistribute them and/or modify them under the terms of
        The Artistic License, a copy of which is available at:
        <a href="http://www.opensource.org/licenses/index.html">http://www.opensource.org/licenses/index.html</a></pre>

</body>

</html>
